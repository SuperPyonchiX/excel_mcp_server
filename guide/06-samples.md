# 📋 Excel MCP Server サンプル集

このファイルでは、Excel MCP Serverを使った実用的なサンプルを紹介します。

## サンプル1: 基本的な売上レポート作成

### AI指示例
```
新しいExcelファイル 'sales_report.xlsx' を作成して、
以下の売上データを入力してください：

商品名 | 1月 | 2月 | 3月 | 合計
------|-----|-----|-----|-----
商品A | 100 | 120 | 110 | (合計を計算)
商品B | 80  | 90  | 95  | (合計を計算)
商品C | 150 | 140 | 160 | (合計を計算)

ヘッダー行は太字にして、背景色を黄色にしてください。
```

### 実行される処理
1. `create_workbook` - ファイル作成
2. `set_range_values` - データ入力
3. `add_formula` - 合計計算
4. `format_cell` - ヘッダー書式設定

---

## サンプル2: 顧客リスト管理

### AI指示例
```
顧客管理用のExcelファイルを作成してください：

ファイル名: customer_list.xlsx
シート名: 顧客データ

以下の情報を含めてください：
- 顧客ID（C001から始まる連番）
- 会社名
- 担当者名
- 電話番号
- メールアドレス
- 登録日

ヘッダーは太字で青色にしてください。
```

### サンプルデータ
```
顧客ID | 会社名      | 担当者 | 電話番号      | メール
C001   | ABC商事     | 田中   | 03-1234-5678  | tanaka@abc.co.jp
C002   | XYZ株式会社 | 佐藤   | 06-9876-5432  | sato@xyz.co.jp
```

---

## サンプル3: 在庫管理システム

### AI指示例
```
在庫管理用のExcelファイルを作成してください：

ファイル名: inventory.xlsx

以下の機能を含めてください：
1. 商品マスター（商品コード、商品名、単価）
2. 入庫記録（日付、商品コード、数量）
3. 出庫記録（日付、商品コード、数量）
4. 現在庫数の計算（入庫合計 - 出庫合計）

在庫が10以下の商品は赤色で強調してください。
```

---

## サンプル4: 月次経費レポート

### AI指示例
```
月次経費レポートを作成してください：

ファイル名: monthly_expenses.xlsx

カテゴリ別の経費を管理：
- 交通費
- 通信費
- 消耗品費
- 会議費
- その他

各カテゴリの合計と全体合計を計算してください。
予算と実績の比較も含めてください。
```

### 数式例
```excel
=SUM(B2:B6)     // カテゴリ合計
=B2/C2*100      // 予算対比％
=IF(B2>C2,"超過","OK")  // 予算チェック
```

---

## サンプル5: 出席管理システム

### AI指示例
```
セミナー出席管理用のExcelファイルを作成してください：

参加者リスト：
- 参加者ID
- 氏名
- 所属
- 連絡先
- 出席状況（○/×）

統計情報：
- 総参加者数
- 出席者数
- 出席率の計算

出席者は緑色、欠席者は赤色で表示してください。
```

---

## サンプル6: データ分析テンプレート

### AI指示例
```
データ分析用のテンプレートを作成してください：

データシート：
- 日付
- 売上
- 顧客数
- 平均単価

分析シート：
- 月別集計
- 前月比較
- 平均値計算
- 最大・最小値
- グラフ用のデータ整理

分析結果は別シートにまとめてください。
```

### 使用する数式
```excel
=SUMIF(A:A,">=2024/1/1",B:B)    // 期間別集計
=AVERAGE(B:B)                   // 平均値
=MAX(B:B)                       // 最大値
=MIN(B:B)                       // 最小値
=COUNTIF(C:C,">0")             // 条件付きカウント
```

---

## サンプル7: プロジェクト管理

### AI指示例
```
プロジェクト管理用のExcelファイルを作成してください：

タスクリスト：
- タスクID
- タスク名
- 担当者
- 開始日
- 終了予定日
- 実際終了日
- ステータス（未着手/進行中/完了）
- 進捗率

進捗サマリー：
- 全体進捗率
- 完了タスク数
- 遅延タスク数

遅延しているタスクは赤色で強調してください。
```

### 条件付き書式の例
```
遅延判定: =AND(E2<TODAY(), G2<>"完了")
進捗色分け: 
- 0-30%: 赤色
- 31-70%: 黄色  
- 71-100%: 緑色
```

---

## サンプル8: 家計簿テンプレート

### AI指示例
```
家計簿のExcelファイルを作成してください：

収入記録：
- 日付
- 項目（給与、副収入等）
- 金額

支出記録：
- 日付
- カテゴリ（食費、光熱費、交通費等）
- 項目
- 金額

月次サマリー：
- 収入合計
- 支出合計
- 収支差額
- カテゴリ別支出割合

支出が予算を超えた場合は警告表示してください。
```

---

## サンプル9: 学習記録管理

### AI指示例
```
学習記録用のExcelファイルを作成してください：

学習ログ：
- 日付
- 科目
- 学習時間
- 学習内容
- 理解度（1-5段階）

統計データ：
- 科目別学習時間
- 週間学習時間
- 月間学習時間
- 平均理解度

目標達成状況を視覚的に表示してください。
```

---

## サンプル10: イベント管理

### AI指示例
```
イベント管理用のExcelファイルを作成してください：

参加者管理：
- 参加者ID
- 氏名
- 連絡先
- 参加費
- 支払い状況

イベント詳細：
- イベント名
- 開催日時
- 会場
- 定員
- 現在申込数

収支管理：
- 収入（参加費）
- 支出（会場費、材料費等）
- 損益計算

申込状況を自動更新できるようにしてください。
```

---

## 実用的なTips

### 1. 効率的なデータ入力
```javascript
// 大量データは一度に設定
const data = [
  ["項目1", "値1", "備考1"],
  ["項目2", "値2", "備考2"],
  // ... 100行のデータ
];
// 一度の呼び出しで全て設定
await setRangeValues("file.xlsx", "Sheet1", "A1", data);
```

### 2. 動的な数式作成
```javascript
// 行に応じた数式の生成
for (let row = 2; row <= 10; row++) {
  await addFormula("file.xlsx", "Sheet1", `D${row}`, `=SUM(A${row}:C${row})`);
}
```

### 3. 条件付き書式の代替
```javascript
// セルの値に応じて書式を変更
const value = await getCellValue("file.xlsx", "Sheet1", "A1");
if (value > 100) {
  await formatCell("file.xlsx", "Sheet1", "A1", {
    font: { color: "FF00FF00" }, // 緑色
    fill: { type: "pattern", pattern: "solid", fgColor: "FFCCFFCC" }
  });
}
```

### 4. データの検証
```javascript
// データの整合性チェック
const searchResult = await findData("file.xlsx", "Sheet1", "重複データ");
if (searchResult.includes(",")) {
  console.log("重複データが見つかりました:", searchResult);
}
```

これらのサンプルを参考に、様々な用途でExcel MCP Serverを活用してください！
